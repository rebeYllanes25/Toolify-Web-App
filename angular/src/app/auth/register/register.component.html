<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<div class="d-flex justify-content-center align-items-center min-vh-100">
  <div class="register-container">
    <div class="text-center mb-4">
      <div class="mb-2">
        <div class="p-3 rounded-circle" style="background-color: rgb(96, 108, 172); display: inline-block;">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="white" viewBox="0 0 24 24">
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z" />
          </svg>
        </div>
      </div>
      <a routerLink="/" class="fw-bold mb-0 text-decoration-none fs-2" style="color: rgb(96, 108, 172);">Toolify</a>
      <p class="text-muted mb-0">Sistema de Ventas de Herramientas</p>
    </div>

    <h5 class="text-center mb-3">
      <i class="bi bi-person-plus me-2"></i> Registro de Cliente
    </h5>
    <p class="text-center text-muted mb-4">Complete el formulario para crear su cuenta</p>

    <!-- Mensajes de éxito/error -->
    <div *ngIf="successMessage" class="alert alert-success">
      <i class="bi bi-check-circle me-2"></i>{{ successMessage }}
    </div>
    
    <div *ngIf="errorMessage" class="alert alert-error">
      <i class="bi bi-exclamation-triangle me-2"></i>{{ errorMessage }}
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <div class="row">
        <!-- Columna 1 -->
        <div class="col-md-4">
          <!-- Nombres -->
          <div class="mb-3 input-group-position">
            <label for="nombres" class="form-label">Nombres</label>
            <i class="fa fa-user input-group-text"></i>
            <input 
              type="text" 
              formControlName="nombres" 
              id="nombres" 
              class="form-control" 
              [class.invalid]="isFieldInvalid('nombre')"
              placeholder="Ingrese sus nombres" 
              maxlength="50">
            <span class="error-message" *ngIf="isFieldInvalid('nombres')">
              {{ getFieldError('nombres') }}
            </span>
          </div>

          <!-- Apellido Materno -->
          <div class="mb-3 input-group-position">
            <label for="apeMaterno" class="form-label">Apellido Materno</label>
            <i class="fa fa-user input-group-text"></i>
            <input 
              type="text" 
              formControlName="apeMaterno" 
              id="apeMaterno" 
              class="form-control" 
              [class.invalid]="isFieldInvalid('apeMaterno')"
              placeholder="Ingrese su apellido materno" 
              maxlength="50">
            <span class="error-message" *ngIf="isFieldInvalid('apeMaterno')">
              {{ getFieldError('apeMaterno') }}
            </span>
          </div>

          <!-- Correo -->
          <div class="mb-3 input-group-position">
            <label for="correo" class="form-label">Correo Electrónico</label>
            <i class="fa fa-envelope input-group-text"></i>
            <input 
              type="email" 
              formControlName="correo" 
              id="correo" 
              class="form-control" 
              [class.invalid]="isFieldInvalid('correo')"
              placeholder="usuario@toolify.com" 
              maxlength="50">
            <span class="error-message" *ngIf="isFieldInvalid('correo')">
              {{ getFieldError('correo') }}
            </span>
          </div>
        </div>

        <!-- Columna 2 -->
        <div class="col-md-4">
          <!-- Apellido Paterno -->
          <div class="mb-3 input-group-position">
            <label for="apePaterno" class="form-label">Apellido Paterno</label>
            <i class="fa fa-user input-group-text"></i>
            <input 
              type="text" 
              formControlName="apePaterno" 
              id="apePaterno" 
              class="form-control" 
              [class.invalid]="isFieldInvalid('apePaterno')"
              placeholder="Ingrese su apellido paterno" 
              maxlength="50">
            <span class="error-message" *ngIf="isFieldInvalid('apePaterno')">
              {{ getFieldError('apePaterno') }}
            </span>
          </div>

          <!-- Contraseña -->
          <div class="mb-3 input-group-position">
            <label for="clave" class="form-label">Contraseña</label>
            <i class="fa fa-lock input-group-text"></i>
            <input 
              [type]="showPassword ? 'text' : 'password'" 
              formControlName="clave" 
              id="clave" 
              class="form-control" 
              [class.invalid]="isFieldInvalid('clave')"
              placeholder="••••••••" 
              maxlength="225">
            <i 
              [class]="showPassword ? 'fa fa-eye-slash' : 'fa fa-eye'" 
              class="toggle-password" 
              (click)="togglePasswordVisibility()"></i>
            <span class="error-message" *ngIf="isFieldInvalid('clave')">
              {{ getFieldError('clave') }}
            </span>
          </div>

          <!-- Número de Documento -->
          <div class="mb-3 input-group-position">
            <label for="nroDoc" class="form-label">Número de Documento</label>
            <i class="fa fa-id-card input-group-text"></i>
            <input 
              type="text" 
              formControlName="nroDoc" 
              id="nroDoc" 
              class="form-control" 
              [class.invalid]="isFieldInvalid('nroDoc')"
              placeholder="Ingrese su número de documento" 
              maxlength="15">
            <span class="error-message" *ngIf="isFieldInvalid('nroDoc')">
              {{ getFieldError('nroDoc') }}
            </span>
          </div>
        </div>

        <!-- Columna 3 -->
        <div class="col-md-4">
          <!-- Dirección -->
          <div class="mb-3 input-group-position">
            <label for="direccion" class="form-label">Dirección</label>
            <i class="fa fa-map-marker-alt input-group-text"></i>
            <input 
              type="text" 
              formControlName="direccion" 
              id="direccion" 
              class="form-control" 
              [class.invalid]="isFieldInvalid('direccion')"
              placeholder="Ingrese su dirección" 
              maxlength="50">
            <span class="error-message" *ngIf="isFieldInvalid('direccion')">
              {{ getFieldError('direccion') }}
            </span>
          </div>

          <!-- Distrito -->
          <div class="mb-3 input-group-position">
            <label for="idDistrito" class="form-label">Distrito</label>
            <i class="fa fa-map input-group-text"></i>
            <select 
              formControlName="idDistrito" 
              id="idDistrito" 
              class="form-select" 
              [class.invalid]="isFieldInvalid('idDistrito')">
              <option value="">Seleccione un distrito</option>
              <option *ngFor="let distrito of distritos" [value]="distrito.idDistrito">
                {{ distrito.nombre }}
              </option>
            </select>
            <span class="error-message" *ngIf="isFieldInvalid('idDistrito')">
              {{ getFieldError('idDistrito') }}
            </span>
          </div>

          <!-- Teléfono -->
          <div class="mb-3 input-group-position">
            <label for="telefono" class="form-label">Teléfono</label>
            <i class="fa fa-phone input-group-text"></i>
            <input 
              type="tel" 
              formControlName="telefono" 
              id="telefono" 
              class="form-control" 
              [class.invalid]="isFieldInvalid('telefono')"
              placeholder="987654321" 
              maxlength="9">
            <span class="error-message" *ngIf="isFieldInvalid('telefono')">
              {{ getFieldError('telefono') }}
            </span>
          </div>
        </div>
      </div>

      <button 
        type="submit" 
        class="btn btn-register w-100 text-white mt-3"
        [disabled]="registerForm.invalid || isLoading">
        <span *ngIf="!isLoading">Registrarse</span>
        <span *ngIf="isLoading">
          <i class="fa fa-spinner fa-spin me-2"></i>Registrando...
        </span>
      </button>
      
      <p class="text-center mt-3">
        ¿Ya tienes cuenta?
        <a (click)="login()" class="titulos-Primary fw-bold text-decoration-none">
          Inicia sesión aquí
        </a>
      </p>
    </form>
  </div>
</div>